{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5"
   },
   "outputs": [],
   "source": [
    "import numpy as np # linear algebra\n",
    "import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\n",
    "import matplotlib.pyplot as plt\n",
    "import matplotlib.image as mpimg\n",
    "import tensorflow as tf\n",
    "from tensorflow import keras\n",
    "import string\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Here UsedSentences.txt Contains the output of the text in the Image and the name of the Image. The name of the image is used to extract the image from the directory and add it to our dataset. Feel free to play with this piece of code and get more clearity of the dataset."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "_cell_guid": "79c7e3d0-c299-4dcb-8224-4455121ee9b0",
    "_uuid": "d629ff2d2480ee46fbb7e2d37f6b5fab8052498a"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "No of Images : 1774\n",
      "Characters :  abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.,*&!@~():`^]¢‘;|-«\n",
      "No of chars : 82\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "#Only Selecting the Images and excluding the directories in the folder\n",
    "# images_names=fnmatch.filter(os.listdir('/kaggle/input/captcha-version-2-images/samples/'),'*.*')\n",
    "from PIL import Image\n",
    "\n",
    "text_file=open(r\"UsedSentences.txt\",\"r\")\n",
    "\n",
    "details=[]\n",
    "outputs=[]\n",
    "names=[]\n",
    "for line in text_file:\n",
    "    a=line.split('#')\n",
    "    outputs.append(a[1].strip('\\n'))\n",
    "    details.append(a[0])\n",
    "\n",
    "for detail in details:\n",
    "    a=detail.split(' ')\n",
    "    names.append(a[0])\n",
    "X=[]\n",
    "\n",
    "for name in names:\n",
    "    img=Image.open('CleanedImages/Encoder_Clean_Renamed/'+name+'.png','r')\n",
    "    img = img.resize((784,32), Image.ANTIALIAS)\n",
    "    img=np.asarray(img)\n",
    "    img=img[:,:,0]\n",
    "    X.append(img)\n",
    "\n",
    "X=np.asarray(X)\n",
    "plt.imshow(X[42])\n",
    "plt.title(outputs[42])\n",
    "print(\"No of Images :\",X.shape[0])\n",
    "\n",
    "symbols = \" \"+string.ascii_lowercase + string.ascii_uppercase+\"0123456789.,*&!@~():`^]¢‘;|-«\"\n",
    "print(\"Characters :\",symbols)\n",
    "print(\"No of chars :\",len(symbols))\n",
    "\n",
    "# print(os.listdir('../input/linesdata/data/sentences/s01/'))\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Here I have created a One Hot Encoded Array. 98 is taken as the maximum number of Character in the Sentences. If the letter is present in the output then it is encoded to 1."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "Y=np.zeros(shape=(len(outputs),98,len(symbols)))\n",
    "for example_no,name in enumerate(outputs):\n",
    "    for letter_no,letter in enumerate(name):\n",
    "        try:\n",
    "            Y[example_no][letter_no][symbols.index(letter)]=1\n",
    "        except:\n",
    "            print(letter,end=\" \")\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Just Reshaping the Shape of X in order to pass it to the convolution."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Shape of X is : (1774, 32, 784, 1)\n"
     ]
    }
   ],
   "source": [
    "X=np.reshape(X,(X.shape[0],X.shape[1],X.shape[2],1))\n",
    "print(\"Shape of X is :\",X.shape)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Neural Network Model \n",
    "# Try Removing Batch Normalisation and see how the performance decreases.\n",
    "def OCRModel():\n",
    "    image=keras.layers.Input((32,784,1))\n",
    "    conv1=keras.layers.Conv2D(16,(3,3),activation='relu',padding='same')(image)\n",
    "    mp1=keras.layers.MaxPooling2D((2,2),padding='same')(conv1)\n",
    "    conv2=keras.layers.Conv2D(32,(3,3),activation='relu',padding='same')(mp1)\n",
    "    mp2=keras.layers.MaxPooling2D((2,2),padding='same')(conv2)\n",
    "    conv3=keras.layers.Conv2D(64,(3,3),activation='relu',padding='same')(mp2)\n",
    "    mp3=keras.layers.MaxPooling2D((2,2),padding='same')(conv3)\n",
    "    conv4=keras.layers.Conv2D(128,(3,3),activation='relu',padding='same')(mp3)\n",
    "    mp4=keras.layers.MaxPooling2D((2,1),padding='same')(conv4)\n",
    "    conv5=keras.layers.Conv2D(256,(3,3),activation='relu',padding='same')(mp4)\n",
    "    mp5=keras.layers.MaxPooling2D((2,1),padding='same')(conv5)\n",
    "    conv6=keras.layers.Conv2D(256,(3,3),activation='relu',padding='same')(mp5)\n",
    "    # mp6=keras.layers.MaxPooling2D((1,3),padding='same')(conv6)\n",
    "    bn=keras.layers.BatchNormalization()(conv6)\n",
    "    sq=keras.backend.squeeze(bn,axis=1)\n",
    "\n",
    "    rn1=keras.layers.Bidirectional(keras.layers.LSTM(256,return_sequences=True))(sq)\n",
    "    rn2=keras.layers.Bidirectional(keras.layers.LSTM(256,return_sequences=True))(rn1)\n",
    "\n",
    "    exd=keras.backend.expand_dims(rn2,axis=2)\n",
    "    maping=keras.layers.Conv2D(len(symbols),(2,2),activation='relu',padding='same')(exd)\n",
    "    maping=keras.backend.squeeze(maping,axis=2)\n",
    "    maping = tf.keras.layers.Softmax()(maping)\n",
    "\n",
    "    # bn = keras.layers.BatchNormalization()(conv3)\n",
    "    model=keras.Model(image,maping)\n",
    "    model.compile(loss='categorical_crossentropy', optimizer='adam')\n",
    "    \n",
    "    return model\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Using TensorFlow backend.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 1/50\n",
      "56/56 [==============================] - 93s 2s/step - loss: 1.6227\n",
      "Epoch 2/50\n",
      "56/56 [==============================] - 98s 2s/step - loss: 1.5175\n",
      "Epoch 3/50\n",
      "56/56 [==============================] - 94s 2s/step - loss: 1.5118\n",
      "Epoch 4/50\n",
      "56/56 [==============================] - 94s 2s/step - loss: 1.4846\n",
      "Epoch 5/50\n",
      "56/56 [==============================] - 92s 2s/step - loss: 1.4532\n",
      "Epoch 6/50\n",
      "56/56 [==============================] - 91s 2s/step - loss: 1.4117\n",
      "Epoch 7/50\n",
      "56/56 [==============================] - 91s 2s/step - loss: 1.3398\n",
      "Epoch 8/50\n",
      "56/56 [==============================] - 91s 2s/step - loss: 1.2534\n",
      "Epoch 9/50\n",
      "56/56 [==============================] - 91s 2s/step - loss: 1.1196\n",
      "Epoch 10/50\n",
      "56/56 [==============================] - 91s 2s/step - loss: 0.9820\n",
      "Epoch 11/50\n",
      "56/56 [==============================] - 92s 2s/step - loss: 0.8484\n",
      "Epoch 12/50\n",
      "56/56 [==============================] - 92s 2s/step - loss: 0.6666\n",
      "Epoch 13/50\n",
      "56/56 [==============================] - 103s 2s/step - loss: 0.5495\n",
      "Epoch 14/50\n",
      "56/56 [==============================] - 98s 2s/step - loss: 0.4908\n",
      "Epoch 15/50\n",
      "56/56 [==============================] - 97s 2s/step - loss: 0.3664\n",
      "Epoch 16/50\n",
      "56/56 [==============================] - 103s 2s/step - loss: 0.2738\n",
      "Epoch 17/50\n",
      "56/56 [==============================] - 104s 2s/step - loss: 0.2325\n",
      "Epoch 18/50\n",
      "56/56 [==============================] - 103s 2s/step - loss: 0.1671\n",
      "Epoch 19/50\n",
      "56/56 [==============================] - 106s 2s/step - loss: 0.1460\n",
      "Epoch 20/50\n",
      "56/56 [==============================] - 106s 2s/step - loss: 0.1145\n",
      "Epoch 21/50\n",
      "56/56 [==============================] - 106s 2s/step - loss: 0.0842\n",
      "Epoch 22/50\n",
      "56/56 [==============================] - 99s 2s/step - loss: 0.0778\n",
      "Epoch 23/50\n",
      "56/56 [==============================] - 108s 2s/step - loss: 0.0620\n",
      "Epoch 24/50\n",
      "56/56 [==============================] - 106s 2s/step - loss: 0.0404\n",
      "Epoch 25/50\n",
      "56/56 [==============================] - 102s 2s/step - loss: 0.0288\n",
      "Epoch 26/50\n",
      "56/56 [==============================] - 92s 2s/step - loss: 0.0243\n",
      "Epoch 27/50\n",
      "56/56 [==============================] - 92s 2s/step - loss: 0.0210\n",
      "Epoch 28/50\n",
      "56/56 [==============================] - 93s 2s/step - loss: 0.0206\n",
      "Epoch 29/50\n",
      "56/56 [==============================] - 92s 2s/step - loss: 0.0217\n",
      "Epoch 30/50\n",
      "56/56 [==============================] - 92s 2s/step - loss: 0.0214\n",
      "Epoch 31/50\n",
      "56/56 [==============================] - 92s 2s/step - loss: 0.0194\n",
      "Epoch 32/50\n",
      "56/56 [==============================] - 92s 2s/step - loss: 0.0188\n",
      "Epoch 33/50\n",
      "56/56 [==============================] - 92s 2s/step - loss: 0.0149\n",
      "Epoch 34/50\n",
      "56/56 [==============================] - 92s 2s/step - loss: 0.0137\n",
      "Epoch 35/50\n",
      "56/56 [==============================] - 92s 2s/step - loss: 0.0131\n",
      "Epoch 36/50\n",
      "56/56 [==============================] - 91s 2s/step - loss: 0.0132\n",
      "Epoch 37/50\n",
      "56/56 [==============================] - 91s 2s/step - loss: 0.0133\n",
      "Epoch 38/50\n",
      "56/56 [==============================] - 91s 2s/step - loss: 0.0123\n",
      "Epoch 39/50\n",
      "56/56 [==============================] - 91s 2s/step - loss: 0.0117\n",
      "Epoch 40/50\n",
      "56/56 [==============================] - 91s 2s/step - loss: 0.0110\n",
      "Epoch 41/50\n",
      "56/56 [==============================] - 91s 2s/step - loss: 0.1290\n",
      "Epoch 42/50\n",
      "56/56 [==============================] - 91s 2s/step - loss: 0.3562\n",
      "Epoch 43/50\n",
      "56/56 [==============================] - 91s 2s/step - loss: 0.1129\n",
      "Epoch 44/50\n",
      "56/56 [==============================] - 91s 2s/step - loss: 0.0289\n",
      "Epoch 45/50\n",
      "56/56 [==============================] - 91s 2s/step - loss: 0.0170\n",
      "Epoch 46/50\n",
      "56/56 [==============================] - 91s 2s/step - loss: 0.0136\n",
      "Epoch 47/50\n",
      "56/56 [==============================] - 90s 2s/step - loss: 0.0123\n",
      "Epoch 48/50\n",
      "56/56 [==============================] - 91s 2s/step - loss: 0.0120\n",
      "Epoch 49/50\n",
      "56/56 [==============================] - 90s 2s/step - loss: 0.0117\n",
      "Epoch 50/50\n",
      "56/56 [==============================] - 91s 2s/step - loss: 0.0108\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<tensorflow.python.keras.callbacks.History at 0x7f7b8c185510>"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from keras.utils.vis_utils import plot_model\n",
    "OCR=OCRModel()\n",
    "OCR.fit(X,Y,epochs=50)\n",
    "# plot_model(OCR, to_file='gan_plot.png', show_shapes=True, show_layer_names=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Decoding the Output of the Model and Comparing it....."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "98\n",
      "predicted: filter that replaces the pixel values with the neighb\n",
      "\n",
      "Orignal:  filter that replaces the pixel values with the neighb\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<matplotlib.image.AxesImage at 0x7f7afc62ca50>"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "xx=OCR.predict(X)\n",
    "index=466\n",
    "c=\"\"\n",
    "print(len(xx[0]))\n",
    "for i in range(len(xx[0])):\n",
    "    c=c+(symbols[np.argmax(xx[index][i])])\n",
    "print(\"predicted:\",c.strip())\n",
    "print(\"\\nOrignal:\",outputs[index])\n",
    "plt.imshow(X[index][:,:,0])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "If you like the Code feel free to fork the Notebook and don't forget to Upvote it. Cheers...."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
